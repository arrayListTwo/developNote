# RegExp

> 正则表达式是一种用来匹配字符串的强有力的武器
> 
> 它的设计思想是一种描述性的语言来给字符串定义一个规则，凡是符合规则的字符串，我们就认为它"匹配"了，否则，该字符串就是不合法的

## 匹配原则

* 简单的单个字符匹配
	* 在正则表达式中，如果直接给出字符，就是精确匹配
	* `\d`：匹配一个数字
	* `\w`：可以匹配一个字母或者数字
	* `\s`：可以匹配一个空格(也包括Tab等空白符)
	* `.`：可以匹配任意一个字符
		* 特殊转义符号
			* `\-`：匹配 - 
* 匹配变长的字符
	* `*`：表示任意个字符(包括0个)
	* `+`：表示至少一个字符
	* `？`：表示0个或者1个字符
	* `{n}`：表示n个字符
	* `{n,m}`：表示n-m个字符
* 更精确的匹配
	* `[]` ：表示范围，`[0-9a-zA-Z\_]`可以匹配一个数字、字母或者下划线
	* `A|B` ： 可以匹配A或者B，所以`(J|j)ava(S|s)cript`可以匹配`JavaScript`、`Javascript`
	* `^` ： 表示**行的开头**，`^\d`表示必须以数字开头
	* `$` ： 表示**行的结束**，`\d$`表示必须以数字结束

## RegExp定义以及测试匹配

#### 定义

* 第一种方式：直接通过`/正则表达式/`写出来

```JavaScript
var re = /ABC\-001/;
```

* 第二种方式：通过`new RegExp('正则表达式');`创建一个`RegExp`对象

```JavaScript
var re = new RegExp('ABC\\-001'); // 因为字符串的转义问题，字符串的两个`\\`实际上是一个`\`
```

#### 测试匹配，正则提供的方法

* `RegExp`对象的`test()`方法用于测试给定的字符串是否符合条件

```JavaScript
re.test("ABC-010"); // true
```

## 正则表达式实现切分字符串，字符串提供的方法

> 用正则表达式切分字符串比用固定的字符更灵活

```JavaScript
'a b   c'.split(' '); // 普通切分，["a", "b", "", "", "c"]
'a b   c'.split(/\s+/); // 正则切分，["a", "b", "c"]
'a,b;; c'.split(/[\,\;\s]+/); // 正则切分，["a", "b", "c"]
```

## 实现分组，正则提供的方法

> 正则表达式还提供了提取子串的强大功能，用`()`表示的就是要提取的分组(
`Group`)

#### 简单实践

* `^(\d{3})-(\d{3,8})`分别定义了两个组，可以直接从匹配的子串中提取

```JavaScript
var re = /^(\d{3})-(\d{3,8})$/;
re.exec('010-12345'); // ['010-12345', '010', '12345']
re.exec('010 12345'); // null
```

* `exec()`方法在匹配成功后，会返回一个`Array`
	* 第一个元素是正则表达式匹配到的整个字符串
	* 后面的字符串表示匹配成功的子串
	* `exec`方法一次只能捕获一个子串到数组中，无论正则表达式是否有全局属性

## 贪婪匹配

* 正则匹配默认是**贪婪匹配**，也就是匹配尽可能多的字符

```JavaScript
var re = /^(\d+)(0*)$/;
re.exec("102300"); // ["102300", "102300", ""]
```
**注意：**由于`\d+`采用贪婪匹配，直接把后面的`0`全部都匹配了，结果`0*`只能匹配空字符串了

* 强制采用非贪婪匹配，让`\d+`采用非贪婪匹配，在其后加`?`

```JavaScript
var re = /^(\d+?)(0*)$/;
re.exec("102300"); // ["102300", "1023", "00"]
```

## 全局搜索

> `JavaScript`的正则表达式还有几个特殊的标志，最常用的是`g`，表示全局匹配
> 使用全局标志`g`时，请不要在正则表达式中出现`^`和`$`

```JavaScript
var r = /test/g;
等同于
var r = new RegExp('test', 'g');
```

* 全局匹配可以多次执行`exec()`方法来搜索一个匹配的字符串。当我们指定`g`标志后，每次运行`exec()`，正则表达式本身会更新`lastIndex`属性，表示上次匹配到的最后索引
* 直到找不到匹配的字符串返回`null`，然后从头开始捕获

```JavaScript
var reg=/hello/g;
reg.lastIndex; //0
reg.exec("abchelloasdasdhelloasd"); // ["hello"]
reg.lastIndex; //8
reg.exec("abchelloasdasdhelloasd"); // ["hello"]
reg.lastIndex; //19
reg.exec("abchelloasdasdhelloasd"); // null
reg.lastIndex; //0
```

* `i` 标志：忽略大小写
* `m` 标志：执行多行匹配